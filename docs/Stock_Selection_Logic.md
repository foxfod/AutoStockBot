# 🦅 주식 선정 및 분석 로직 가이드 (Stock Selection Logic)

이 문서는 봇이 매수할 종목을 어떻게 발굴하고, 필터링하며, 최종적으로 선정하는지에 대한 상세 로직을 설명합니다.

---

## 1. 개요 (Overview)

봇의 종목 선정 과정은 크게 **3단계**로 이루어집니다.

1.  **후보군 수집 (Candidate Collection)**: 시장 전체 또는 특정 리스트에서 분석 대상 종목을 추립니다.
2.  **1차 기술적 필터링 (Technical Filtering)**: 지표(RSI, 변동성 등)를 사용하여 위험한 종목을 즉시 제외합니다.
3.  **2차 AI 심층 분석 (AI Deep Analysis)**: 살아남은 후보들을 GPT-4o-mini가 뉴스, 차트 패턴, 재료를 종합하여 점수(Score)를 매깁니다.

---

## 2. 시장별 선정 로직 (Market-Specific Logic)

### 🇰🇷 한국 시장 (KR Market)

#### A. 후보군 수집 (Universe)
-   **대상**: 코스피(KOSPI) 및 코스닥(KOSDAQ) 전 종목 중 **거래량 상위 2000개**.
-   **제외 대상**:
    -   관리종목, 거래정지, 환기종목
    -   ETF, ETN, 스팩(SPAC)
    -   동전주 (1,000원 미만)
    -   초고가주 (500,000원 이상 - 예산 효율성 문제)

#### B. 1차 기술적 필터 (Technical Filter)
다음 조건 중 하나라도 해당되면 **즉시 탈락**합니다.
1.  **RSI (상대강도지수)**: **70 이상** (과매수 구간, 고점 추격 매수 방지)
2.  **변동성 (Daily Change)**: 당일 등락률 **15% 이상** (이미 폭등한 종목 추격 방지)
    -   *단, 상한가 근접 종목은 별도 로직으로 처리될 수 있음*
3.  **거래대금**: 최근 5분 거래대금 저조 (유동성 부족)
4.  **이동평균선 (MA)**: 주가가 20일 이평선 아래에 위치 (하락 추세)

#### C. AI 분석 (Scoring)
-   **기준 점수**: **60점 이상** 합격
-   **입력 데이터**: 최근 30분/일봉 차트, 호가 잔량, 관련 뉴스 기사 요약
-   **판단 기준**: 재료의 지속성, 외국인/기관 수급(추정), 차트의 지지선 확보 여부

---

### 🇺🇸 미국 시장 (US Market)

#### A. 후보군 수집 (Universe)
미국 시장은 전 종목 검색 대신, **엄선된 우량주 및 성장주 리스트(약 60개)**를 순환하며 감시합니다.
-   **Mega Tech**: NVDA, TSLA, AAPL, MSFT, GOOGL, AMZN, META
-   **Semiconductor**: AMD, INTC, MU, AVGO, QCOM, TSM, SOXL(3x Bull)
-   **Growth/Software**: PLTR, SNOW, CRWD, NET, DDOG, UBER
-   **EV/Auto**: RIVN, LCID, F, GM
-   **Crypto/Fintech**: COIN, HOOD, SQ, PYPL, MARA
-   **Indices**: QQQ, TQQQ(3x Bull)

#### B. 1차 기술적 필터 (Technical Filter)
미국장은 변동성이 크므로 한국장보다 조금 더 여유로운 기준을 적용합니다. (최근 업데이트 반영)
1.  **예산 확인**: 현재가(Price) > 설정된 1슬롯 예산 (예산 초과 시 스킵)
2.  **RSI (상대강도지수)**: **75 이상** (과매수) → 탈락
    -   *기존 70에서 75로 완화됨*
3.  **변동성 (Daily Change)**: 당일 등락률 **20% 이상** → 탈락
    -   *기존 15%에서 20%로 완화됨 (미국장의 폭발적 상승력 고려)*
4.  **추세 (Trend)**:
    -   기본적으로 **상승 추세(UP)** 선호
    -   **하락 추세(DOWN)**인 경우: **RSI < 50** 이면 '저점 매수(Dip Buying)' 기회로 보고 **통과**. 그렇지 않으면 탈락.

#### C. AI 분석 (Scoring)
-   **기준 점수**: **55점 이상** 합격 (한국장보다 5점 낮음, 적극적 매수 유도)
-   **시장 컨텍스트 (Market Context)**:
    -   **QQQ(나스닥 100)** 지수의 등락률을 참고하여 가산점/감점 부여.
    -   시장 폭락장(Bear Market)일 경우 매수 기준이 매우 엄격해짐.

---

## 3. 매수 및 매도 전략 (Trading Strategy)

### 매수 (Buy)
-   **슬롯 배분**: 최대 슬롯 개수(기본 3개) 내에서 분할 매수.
-   **예산**: 총 예수금의 N분의 1 (자동 계산).

### 매도 (Sell)
AI가 매수 시점에 수립한 전략을 따릅니다.
1.  **목표가 (Target Profit)**:
    -   보통 +2% ~ +5% 사이에서 AI가 변동성을 고려해 설정.
    -   도달 시 **전량 익절** 또는 **트레일링 스탑** 발동.
2.  **손절가 (Stop Loss)**:
    -   보통 -1.5% ~ -3% 내외.
    -   도달 시 **가차 없이 시장가 손절**.
3.  **청산 시간 (Time-Cut)**:
    -   **한국장**: 15:20 (종가 단일가 매매 전)
    -   **미국장**: 05:50 (애프터마켓 종료 전)
    -   해당 시간까지 승부가 안 나면 전량 청산하여 오버나잇 리스크를 제거합니다.

---

## 4. Top 10 선정 로직 (Dashboard)
대시보드의 'Top 10'은 실제 매수와는 별개로, **장 시작 전(Pre-Market)** 또는 **장중**에 유망한 종목을 미리 선별해두는 기능입니다.
-   **로직**: 위와 동일한 필터/AI 과정을 거치되, 점수가 높은 순서대로 10개를 정렬하여 보여줍니다.
-   **미국 Top 10**: 프리마켓 거래량 및 등락률을 반영하지 않고, 전일 종가 및 현재가 기준으로 기술적 매력도를 평가합니다.

---
*Last Updated: 2026-02-12*
